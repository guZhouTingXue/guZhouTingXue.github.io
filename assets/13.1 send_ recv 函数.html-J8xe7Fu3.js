import{_ as r}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as A,d as t,a as s,f as h,e as a,w as n,r as k,o as g}from"./app-DV62RuHA.js";const c="/assets/13.1%20send_%20recv%20%E5%87%BD%E6%95%B0-rWlnOn5Q.webp",B="/assets/13.1%20send_%20recv%20%E5%87%BD%E6%95%B0-1-BFKm_hc3.webp",o="data:image/webp;base64,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",y="data:image/webp;base64,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",u="/assets/13.1%20send_%20recv%20%E5%87%BD%E6%95%B0-4-BZccoeS6.webp",v={};function b(F,i){const p=k("RouteLink"),d=k("Tabs");return g(),A("div",null,[i[21]||(i[21]=t(`<h1 id="_13-1-send-recv-函数" tabindex="-1"><a class="header-anchor" href="#_13-1-send-recv-函数"><span>13.1 send&amp; recv 函数</span></a></h1><h2 id="send" tabindex="-1"><a class="header-anchor" href="#send"><span>send</span></a></h2><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">NAME</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       send, sendto, sendmsg </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> send a message on a socket</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SYNOPSIS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       #include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;sys/types.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       #include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;sys/socket.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       ssize_t</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> send</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> sockfd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">buf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">size_t</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> flags</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>参数</th><th>值</th><th>用途</th><th>说明</th></tr></thead><tbody><tr><td>sockfd</td><td></td><td>The argument sockfd is the file descriptor of the sending socket.</td><td></td></tr><tr><td>buf</td><td></td><td>the message is found in buf</td><td>存储发送msg 的buf</td></tr><tr><td>len</td><td></td><td></td><td>msg的长度</td></tr><tr><td>RETURN</td><td></td><td></td><td>On success, these calls return <strong>the number of bytes sent</strong>. <br>On error, <strong>-1</strong> is returned, and <strong>errno</strong> is set appropri ately.<br></td></tr></tbody></table><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>The send() call may be used only when the socket is in a connected state (so that the intended recipient is known). The only difference between send() and write(2) is the presence of flags.</p></div><table><thead><tr><th>flag值</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td>MSG_OOB</td><td>Sends out-of-band data on sockets that support this notion (e.g., of type SOCK_STREAM); the underlying protocol must also support out-of-band data.<br></td><td>OOB是个淘汰的东西，不应该使用（使用标准都没有确定），不是书上有我也不会看</td></tr><tr><td>MSG_DONTWAIT</td><td>Enables nonblocking operation; if the operation would block, EAGAIN or EWOULDBLOCK is returned. <br> This provides similar behavior to setting the O_NONBLOCK flag (via the fcntl(2) F_SETFL operation), <br> but differs in that MSG_DONTWAIT is a per-call option,<br> whereas O_NONBLOCK is a setting on the open file description (see open(2)), <br> which will affect all threads in the calling process and as well as other processes that hold file descriptors referring to the same open file description.</td><td>在调用send 时设置该标志，send不会阻塞，仅针对当前send有效，file description 仍然是阻塞的。使用fcntl 设置 O_NONBLOCK 会使file description 变成非阻塞的</td></tr><tr><td>MSG_DONTROUTE</td><td>Don&#39;t use a gateway to send out the packet, send to hosts only on directly connected networks. <br> This is usually used only by diagnostic or routing programs. <br> This is defined only for protocol families that route; packet sockets don&#39;t.</td><td></td></tr></tbody></table><h3 id="msg-oob-发送紧急消息" tabindex="-1"><a class="header-anchor" href="#msg-oob-发送紧急消息"><span>MSG_OOB： 发送紧急消息</span></a></h3><p><code>out-of-band</code> 带外数据</p><h4 id="发送紧急消息" tabindex="-1"><a class="header-anchor" href="#发送紧急消息"><span>发送紧急消息</span></a></h4><p>客户端发紧急消息给服务端</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sock, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;123&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">strlen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;123&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    send</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sock, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;4&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">strlen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;4&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), MSG_OOB);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    write</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sock, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;567&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">strlen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;567&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">	send</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sock, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;890&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">strlen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;890&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), MSG_OOB);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用<code>wireshark</code> 抓包，查看发送的消息：<br><img src="`+c+'" alt="|499x102" loading="lazy"><br> 使用带有 MSG_OOB 选项发送的msg具有Urg值</p><p>查看两个Urg msg：<br><img src="'+B+'" alt="|406x182" loading="lazy"><br> 两个msg 的Urgent 标志位均为1<br> 第一个Urg的 Pointer为1<br><img src="'+o+'" alt="" loading="lazy"><br> 第二个Urg的Pointer为3<br><img src="'+y+`" alt="" loading="lazy"></p><h4 id="接收紧急消息" tabindex="-1"><a class="header-anchor" href="#接收紧急消息"><span>接收紧急消息</span></a></h4><p>实现：</p><div class="language-cpp line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="cpp" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro has-highlighted vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> recv_sock;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> urg_handler</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> signo</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	int</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    char</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> buf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[BUF_SIZE];</span></span>
<span class="line highlighted"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> recv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(recv_sock, buf, BUF_SIZE, MSG_OOB);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        buf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[str_len] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Urgent data received: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, buf);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> sigaction</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> act</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    act</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">sa_handler</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> urg_handler;   </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    sigemptyset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#56B6C2;">&amp;</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">act</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">sa_mask</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    act</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">sa_flags</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;   </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    fcntl</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(recv_sock, F_SETOWN, </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getpid</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // Set the owner of the socket to the current process</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sigaction</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(SIGURG, </span><span style="--shiki-light:#A626A4;--shiki-dark:#56B6C2;">&amp;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">act, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">==</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        error_handling</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;sigaction() error&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> recv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(recv_sock, message, BUF_SIZE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">==</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(errno </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">==</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> EINTR) </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">continue</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // Interrupted by signal</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">            error_handling</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;recv() error&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">==</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            break</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // Connection closed</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        message</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[str_len] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\0</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Message from client: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, message);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    close</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(recv_sock);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    close</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sock);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><table><thead><tr><th>行号</th><th>功能</th><th>说明</th></tr></thead><tbody><tr><td>1</td><td>连接的客户端的socket</td><td>因为要在信号处理函数中读取数据，将客户端socket fd定义为全局变量，以便处理函数访问</td></tr><tr><td>3-12</td><td></td><td><span style="background:#fff88f;">问：</span>读取时可不可以不用MSG_OOB 选项？<br><span style="background:#fff88f;">问：</span>这里进入信号处理，一定产生了信号，是否一定有数据可读（recv是否一定返回大于0？）从而不需要判断出错（返回值小于0）的情况？</td></tr><tr><td>16-23</td><td>设置SIGURG 信号处理进程 以及 对应的函数</td><td></td></tr><tr><td>21</td><td>设置处理的进程</td><td>”多个进程可以共同拥有1个套接字的文件描述符“，发生信号时需要指定处理信号的进程，通过fcntl 可以指定socket 的拥有者，拥有者负责处理信号。getpid（）返回调用进程的pid。21行语句的含义：设置当前进程为recv_sock 的拥有者（通过F_SETOWN指定设置参数）。socket 原本属于操作系统，而操作系统对于 SIGURG 信号的Action 为Ign-忽略。</td></tr><tr><td>25-35</td><td>正常接收并打印数据</td><td></td></tr></tbody></table><p>效果：<br> 在虚拟机中运行服务端以及客户端：</p><ol><li>启动服务端</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>ming@ubuntu:/media/sf_share/Network/build$ ./Network 192.168.56.101 10086</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="2"><li>启动客户端</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>ming@ubuntu:/media/sf_share/Network/build$ ./MSG_OOB 192.168.56.101 10086</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ol start="3"><li>服务端打印信息：</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>Message from client: 123</span></span>
<span class="line"><span>Urgent data received: 4</span></span>
<span class="line"><span>Message from client: 567</span></span>
<span class="line"><span>Urgent data received: 0</span></span>
<span class="line"><span>Message from client: 89</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意到信号处理中 recv 接收的数据长度为 BUF_SIZE 远远大于发生的msg 的长度，但是为什么在发送 890 时，处理函数中仅recv 到1字节数据？</p><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>带外数据的含义是：<br> 通过完全不同的通信路径传输的数据</p><p>真正意义上的 Out-of-band 需要通过单独的通信路径高速传输数据，但<strong>TCP不另外提供</strong>，只利用TCP的<strong>紧急模式（Urgent mode）</strong> 进行传输</p></div><ul><li>TCP没有单独的路径传输带外数据：换句话说recv 带有 MSG_OOB 的带外数据 和 recv 非MSG_OOB 数据的传输方式相同</li><li>紧急模式：会产生SIGURG信号</li></ul><h5 id="紧急模式" tabindex="-1"><a class="header-anchor" href="#紧急模式"><span>紧急模式</span></a></h5><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>MSG_OOB真正意义在于督促数据接收对象尽快处理数据</p></div><ul><li>TCP 保持传输顺序：带外数据按照发送顺序传输，并不会比非带外数据更快到达</li><li>如何尽快处理：通过信号处理-可以中断其他操作</li></ul><p><strong>识别带外数据</strong><br> 书中的解释没看懂<br> 示例为传输890，假设已传输之前的数据，字符8在输出缓冲中的偏移量为0，紧急指针的偏移量为3，”紧急指针指向的偏移量为3之前的部分就是紧急消息“</p><p><span style="background:#fff88f;">几个问题：</span></p><ul><li>非紧急消息数据会和紧急消息数据混杂在一起吗？</li><li>如果不会混杂，那么带有URG 标志的msg 的所有用户数据不都是紧急数据？紧急指针有什么用？</li><li>如果会混杂，那非紧急消息在紧急消息前面（偏移量小于紧急指针），单个紧急指针也没办法区分紧急和非紧急吧？</li></ul><p>在 SIGURG 信号处理函数中，如果不指定接收MSG_OOB<br> 实现：</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> recv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(recv_sock, buf, BUF_SIZE</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>效果：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>Message from client: 123</span></span>
<span class="line"><span>str_len: 3</span></span>
<span class="line"><span>Urgent data received: 567</span></span>
<span class="line"><span>str_len: 0</span></span>
<span class="line"><span>Message from client: 89</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>收不到4的紧急消息</li><li>567不是紧急消息，但是在信号处理中读取</li><li>0也没有读到</li></ul><p>参考AI解答：</p><ul><li>recv 时若未指定MSG_OOB 则只会读取普通数据</li><li>紧急消息只包含一个字节数据</li><li>对于第4行str_len 为0，是因为主循环recv从接收缓冲中读取完数据，client 发送了FIN，所以recv 返回0</li></ul><h6 id="偏移量的理解" tabindex="-1"><a class="header-anchor" href="#偏移量的理解"><span>偏移量的理解</span></a></h6><table><thead><tr><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>Urgent data</th></tr></thead><tbody><tr><td>4</td><td>Urgent Pointer = 1</td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>4</td></tr><tr><td>8</td><td>9</td><td>0</td><td>Urgent Pointer = 3</td><td></td><td></td><td></td><td></td><td></td><td></td><td>0</td></tr><tr><td>4</td><td>5</td><td>6</td><td>7</td><td>8</td><td>9</td><td>0</td><td>Urgent Pointer = 7</td><td></td><td></td><td>0</td></tr></tbody></table><h5 id="bug-还是丢失数据" tabindex="-1"><a class="header-anchor" href="#bug-还是丢失数据"><span>BUG？还是丢失数据？</span></a></h5><p>增加str_len的打印，第一次运行时没有打印4</p><div class="language- line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>ming@ubuntu:/media/sf_share/Network/build$ ./Network 192.168.56.101 10086</span></span>
<span class="line"><span>Message from client: 123</span></span>
<span class="line"><span>Message from client: 567</span></span>
<span class="line"><span>str_len: 1</span></span>
<span class="line"><span>Urgent data received: 0</span></span>
<span class="line"><span>Message from client: 89</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span>ming@ubuntu:/media/sf_share/Network/build$ ./Network 192.168.56.101 10086</span></span>
<span class="line"><span>Message from client: 123</span></span>
<span class="line"><span>str_len: 1</span></span>
<span class="line"><span>Urgent data received: 4</span></span>
<span class="line"><span>Message from client: 567</span></span>
<span class="line"><span>str_len: 1</span></span>
<span class="line"><span>Urgent data received: 0</span></span>
<span class="line"><span>Message from client: 89</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>看第二行 和 第三行，在123 和 567 之间没有收到4？？？</p><p>参考AI：</p><ul><li>OOB 缓冲只有1个字节</li><li>客户端发送数据过快，在4还没有被读取前，接收缓冲已经收到 567 和 890</li><li>”Unix 信号是不排队的（Standard Signals are not queued），如果两次 SIGURG 发生得太快，它们会被合并成一次信号通知。“<br><span style="background:#d2cbff;">问：</span>这里就有疑问了，根据之前讲的信号不能嵌套，在处理一个信号时如果再次接收到信号，不会处理新的信号，那是不是和这里的 ”不排队“、”合并“冲突了？？？</li></ul><p>与其说是信号合并，我更接收OOB 缓冲的1字节数据被更新了。</p><ul><li>OOB不是队列；OOB 是指针；OOB 是状态：只能知道OOB发生了变化，并获取最新的OOB值，无法获知 OOB变化了几次，如果有多次变化，中间的变化过程。也就是只保留最新结果，不缓存中间状态。</li></ul><h4 id="在wsl中启动客户端" tabindex="-1"><a class="header-anchor" href="#在wsl中启动客户端"><span>在wsl中启动客户端</span></a></h4><p>在wsl中运行客户端，连接到虚拟机中的linux 服务端<br> 效果：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>ming@ubuntu:/media/sf_share/Network/build$ ./Network 192.168.56.101 10086</span></span>
<span class="line"><span>Message from client: 123456789</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>没有调用信号处理</li></ul><p>抓到的msg：<br><img src="`+u+'" alt="" loading="lazy"><br> 第一次发送了012，3bytes数据，第二次发送了 4567890. 第二包数据带有URG ，Urg pointer 值为7<br> 和理论正确的包相比，多了 TSval 和 TSecr，AI 告知是时间戳，应该不影响 OOB</p><p><span style="background:#fff88f;">问：</span>为什么使用WSL 和 在 虚拟机中 运行的结果不一样？为什么WSL 连接的结果是这个样子？？？</p><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>来自ChatGPT<br> TCP OOB 的定义本身就是模糊的，不同 OS 对 urgent pointer 的解释并不一致。WSL 中你看<br> 到的，其实是 Windows TCP 的 urgent 语义，而不是 Linux 的</p></div><h3 id="msg-dontwait-调用send时不阻塞" tabindex="-1"><a class="header-anchor" href="#msg-dontwait-调用send时不阻塞"><span>MSG_DONTWAIT：调用send时不阻塞</span></a></h3>',58)),s("ol",null,[i[8]||(i[8]=s("li",null,[a("什么情况下send会阻塞？"),s("br"),a(" 接收（读取）数据的阻塞很好理解、测试，没有数据时（数据为空）时阻塞。但是send呢？对于socket，那默认情况有一定的缓冲，要把缓冲填满然后等待有空余？只要接收方不从接收缓冲中读取数据，那么发送缓冲就可以被填满，然后阻塞send")],-1)),s("li",null,[i[1]||(i[1]=a("查看缓冲区大小",-1)),i[2]||(i[2]=s("br",null,null,-1)),i[3]||(i[3]=a(" 参考 ",-1)),h(p,{to:"/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/9.1%20%E5%A5%97%E6%8E%A5%E5%AD%97%E7%9A%84%E5%A4%9A%E7%A7%8D%E5%8F%AF%E9%80%89%E9%A1%B9.html"},{default:n(()=>[...i[0]||(i[0]=[a("9.1 套接字的多种可选项",-1)])]),_:1}),i[4]||(i[4]=s("br",null,null,-1)),i[5]||(i[5]=a(" 读取发送缓冲区 以及 接收缓冲区大小",-1)),i[6]||(i[6]=s("br",null,null,-1)),i[7]||(i[7]=a(" 结果：",-1))])]),i[22]||(i[22]=t(`<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>Input buffer size: 16384</span></span>
<span class="line"><span>Output buffer size: 131072</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>那么填充满发送以及接收缓冲的字节数：16384 + 131072 = 147456<br> 有点多，改小一点，将客户端的接收缓冲设置为5000，服务端的发送缓冲设置为5000</p><p>注意虽然接收缓冲大小设置的是5000，但实际大小并不是5000（而是10000）<br> 发送缓冲大小变化为设定值</p><ol start="3"><li>测试<br> 实现：</li></ol><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    char</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> send_buf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">atoi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">argv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;buf size: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">atoi</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">argv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]));</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;send data</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> send</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(recv_sock, send_buf, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">sizeof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(send_buf), </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">        printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;str_len: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, str_len);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container warning"><p class="hint-container-title">注意</p><p>注意这里send之前的打印信息需要换行（刷新stdout 缓冲，立即显示打印信息），否则可能因为send阻塞，导致写入stdout缓冲中的数据没有被输出到屏幕</p></div><p>效果：<br> 在发送13000字节长度数据时</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>ming@ubuntu:/media/sf_share/Network/build$ ./Network 192.168.56.101 10086 13000</span></span>
<span class="line"><span>TCP sock sendbuffer size : 16384</span></span>
<span class="line"><span>after set bufsize, TCP sock sendbuffer size : 5000</span></span>
<span class="line"><span>send data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>send 阻塞住了</p><p>在发送12000字节长度数据时：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>ming@ubuntu:/media/sf_share/Network/build$ ./Network 192.168.56.101 10086 12000</span></span>
<span class="line"><span>TCP sock sendbuffer size : 16384</span></span>
<span class="line"><span>after set bufsize, TCP sock sendbuffer size : 5000</span></span>
<span class="line"><span>buf size: 12000</span></span>
<span class="line"><span>send data</span></span>
<span class="line"><span>str_len: 12000</span></span>
<span class="line"><span>send data</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>第一次成功发送了12000字节长度数据，第二次写入时阻塞</p><p>两个结论：</p><ol><li>send在缓冲大小不足时被阻塞</li><li>send不被阻塞的数据长度小于 发送缓冲大小 + 接收缓冲大小</li></ol><p><strong>设置MSG_DONTWAIT</strong></p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> send</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(recv_sock, send_buf, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">sizeof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(send_buf), MSG_DONTWAIT);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">==</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> -</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">		unix_error</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;send error&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>结果：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>11 send error: Resource temporarily unavailable</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>错误信息提示：资源暂时不可用<br> EAGAIN 和 EWOULDBLOCK 是一个值</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> EAGAIN</span><span style="--shiki-light:#986801;--shiki-dark:#E06C75;">                         0x</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">11</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> EWOULDBLOCK</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                    EAGAIN</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="recv" tabindex="-1"><a class="header-anchor" href="#recv"><span>recv</span></a></h2><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">NAME</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       recv, recvfrom, recvmsg </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> receive a message from a socket</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SYNOPSIS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       #include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;sys/types.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       #include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;sys/socket.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       ssize_t</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> recv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> sockfd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">buf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">size_t</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> flags</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>参数</th><th>值</th><th>用途</th><th>说明</th></tr></thead><tbody><tr><td>RETURN VALUE</td><td></td><td></td><td>These calls return the number of bytes received, or -1 if an error occurred.</td></tr></tbody></table><table><thead><tr><th>flag值</th><th>含义</th><th>说明</th></tr></thead><tbody><tr><td>MSG_PEEK</td><td>This flag causes the receive operation to return data from the beginning of the receive queue without removing that data from the queue. Thus, a subsequent receive call will return the same data.<br></td><td></td></tr><tr><td>MSG_DONTWAIT</td><td></td><td>和send中的功能相同</td></tr></tbody></table><h3 id="检查输入缓冲" tabindex="-1"><a class="header-anchor" href="#检查输入缓冲"><span>检查输入缓冲</span></a></h3><p>MSG_PEEK 读取输入缓冲中的数据，但是不会删除数据。配合 MSG_DONTWAIT 用来“验证待读取数据存在与否”</p><p>实现：</p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    while</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> recv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(recv_sock, buf, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">sizeof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(buf)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, MSG_DONTWAIT </span><span style="--shiki-light:#A626A4;--shiki-dark:#56B6C2;">|</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> MSG_PEEK);</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">&gt;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            break</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    buf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[str_len] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Buffering </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bytes: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, str_len, buf);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    str_len </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> recv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(recv_sock, buf, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">sizeof</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(buf)</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    buf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[str_len] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Read </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> bytes: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, str_len, buf);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>行号</th><th>功能</th><th>说明</th></tr></thead><tbody><tr><td>2</td><td>非阻塞、PEEK 方式读取输入缓冲中的数据</td><td></td></tr><tr><td>9</td><td>正常的recv读取缓冲中的数据</td><td></td></tr></tbody></table><p>效果：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>Buffering 3 bytes: abc</span></span>
<span class="line"><span>Read 3 bytes: abc</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="readv-writev" tabindex="-1"><a class="header-anchor" href="#readv-writev"><span>readv &amp; writev</span></a></h2><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">NAME</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       readv, writev, preadv, pwritev </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> read </span><span style="--shiki-light:#A626A4;--shiki-dark:#ABB2BF;">or</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> write data into multiple buffers</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">SYNOPSIS</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       #include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;sys/uio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       ssize_t</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> readv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> fd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> iovec</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> iovcnt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">       ssize_t</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> writev</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> fd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> iovec</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#383A42;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;"> iovcnt</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>行号</th><th>功能</th><th>说明</th></tr></thead><tbody><tr><td>fd</td><td></td><td>writev: 要写入的fd；<br>readv: 从fd中读数据</td></tr><tr><td>iov</td><td>The pointer iov points to an array of iovec structures</td><td></td></tr><tr><td>iovcnt</td><td></td><td>iov的数量</td></tr></tbody></table><p><strong>iovec</strong></p><div class="language-cpp line-numbers-mode" data-highlighter="shiki" data-ext="cpp" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">         struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> iovec</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">               void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">  *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">iov_base;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    /* Starting address */</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">               size_t</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> iov_len;</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">     /* Number of bytes to transfer */</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">           };</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">相关信息</p><p>writev函数可以将分散保存在多个缓冲中的数据一并发送，通过readv函数可以由多个缓冲分别接收</p></div><p>writev：将保存在iov指向的缓冲中的数据写入到fd指向的文件<br> readv：将fd指向的文件中的数据写入到iov指向的缓冲（按iov的顺序写入）</p><h3 id="writev" tabindex="-1"><a class="header-anchor" href="#writev"><span>writev</span></a></h3><p>在iov中存放字符串，输出到标准输出</p><div class="language-cpp line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="cpp" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;sys/uio.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;string.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> iovec</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_base</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Hello, &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_len</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> strlen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">char</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_base</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_base</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">void</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;World!</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;       </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_len</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> strlen</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">((</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">char</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_base</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    writev</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, iov, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // Write to standard output (file descriptor 1)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>效果：</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-"><span class="line"><span>Hello, World!</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="readv" tabindex="-1"><a class="header-anchor" href="#readv"><span>readv</span></a></h3><p>从标准输入中读取数据，分别存放到不同的ivo中<br> 实现：</p><div class="language-cpp line-numbers-mode has-collapsed-lines collapsed" data-highlighter="shiki" data-ext="cpp" style="--vp-collapsed-lines:15;--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-cpp"><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;sys/uio.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;string.h&gt;</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#include</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &lt;stdio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">#define</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> BUF_SIZE</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">int</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> main</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">{</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    char</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> buffer0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[BUF_SIZE] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    char</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> buffer1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[BUF_SIZE] </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">};</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    struct</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> iovec</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">];</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_base</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> buffer0;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_len</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> BUF_SIZE; </span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_base</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> buffer1;</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">    iov</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">iov_len</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> BUF_SIZE;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;readv returned: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">readv</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, iov, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">));</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Buffer 0: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, buffer0);</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    printf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Buffer 1: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, buffer1);  </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div><div class="collapsed-lines"></div></div><p>效果：</p>`,47)),h(d,{data:[{id:"回车"},{id:"1回车"},{id:"12回车回车"},{id:"1234回车"},{id:"1~6回车"},{id:"1~9回车"}]},{title0:n(({value:l,isActive:e})=>[...i[9]||(i[9]=[a("回车",-1)])]),title1:n(({value:l,isActive:e})=>[...i[10]||(i[10]=[a("1回车",-1)])]),title2:n(({value:l,isActive:e})=>[...i[11]||(i[11]=[a("12回车回车",-1)])]),title3:n(({value:l,isActive:e})=>[...i[12]||(i[12]=[a("1234回车",-1)])]),title4:n(({value:l,isActive:e})=>[...i[13]||(i[13]=[a("1~6回车",-1)])]),title5:n(({value:l,isActive:e})=>[...i[14]||(i[14]=[a("1~9回车",-1)])]),tab0:n(({value:l,isActive:e})=>[...i[15]||(i[15]=[s("div",{class:"language- line-numbers-mode","data-highlighter":"shiki","data-ext":"",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[s("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[s("code",{class:"language-"},[s("span",{class:"line"},[s("span",null,"ming@ubuntu:/media/sf_share/Network/build$ ./Network")]),a(`
`),s("span",{class:"line"},[s("span")]),a(`
`),s("span",{class:"line"},[s("span",null,"readv returned: 1")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 0:")]),a(`
`),s("span",{class:"line"},[s("span")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 1:")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),tab1:n(({value:l,isActive:e})=>[...i[16]||(i[16]=[s("div",{class:"language- line-numbers-mode","data-highlighter":"shiki","data-ext":"",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[s("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[s("code",{class:"language-"},[s("span",{class:"line"},[s("span",null,"1")]),a(`
`),s("span",{class:"line"},[s("span",null,"readv returned: 2")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 0: 1")]),a(`
`),s("span",{class:"line"},[s("span")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 1:")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),tab2:n(({value:l,isActive:e})=>[...i[17]||(i[17]=[s("div",{class:"language- line-numbers-mode","data-highlighter":"shiki","data-ext":"",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[s("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[s("code",{class:"language-"},[s("span",{class:"line"},[s("span",null,"12")]),a(`
`),s("span",{class:"line"},[s("span")]),a(`
`),s("span",{class:"line"},[s("span",null,"readv returned: 4")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 0: 12")]),a(`
`),s("span",{class:"line"},[s("span")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 1:")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),tab3:n(({value:l,isActive:e})=>[...i[18]||(i[18]=[s("div",{class:"language- line-numbers-mode","data-highlighter":"shiki","data-ext":"",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[s("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[s("code",{class:"language-"},[s("span",{class:"line"},[s("span",null,"1234")]),a(`
`),s("span",{class:"line"},[s("span",null,"readv returned: 5")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 0: 123")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 1: 4")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),tab4:n(({value:l,isActive:e})=>[...i[19]||(i[19]=[s("div",{class:"language- line-numbers-mode","data-highlighter":"shiki","data-ext":"",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[s("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[s("code",{class:"language-"},[s("span",{class:"line"},[s("span",null,"123456")]),a(`
`),s("span",{class:"line"},[s("span",null,"readv returned: 6")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 0: 123")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 1: 456▒")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),tab5:n(({value:l,isActive:e})=>[...i[20]||(i[20]=[s("div",{class:"language- line-numbers-mode","data-highlighter":"shiki","data-ext":"",style:{"--shiki-light":"#383A42","--shiki-dark":"#abb2bf","--shiki-light-bg":"#FAFAFA","--shiki-dark-bg":"#282c34"}},[s("pre",{class:"shiki shiki-themes one-light one-dark-pro vp-code"},[s("code",{class:"language-"},[s("span",{class:"line"},[s("span",null,"123456789")]),a(`
`),s("span",{class:"line"},[s("span",null,"readv returned: 6")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 0: 123")]),a(`
`),s("span",{class:"line"},[s("span",null,"Buffer 1: 456b")])])]),s("div",{class:"line-numbers","aria-hidden":"true",style:{"counter-reset":"line-number 0"}},[s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"}),s("div",{class:"line-number"})])],-1)])]),_:1}),i[23]||(i[23]=s("ul",null,[s("li",null,"标准输入中回车会被当作一字节输入"),s("li",null,"在第一个（前面一个）iov指向的接收缓冲满了之后填写第二个（后面的）接收缓冲"),s("li",null,"一旦有数据，readv就会写入到iov中并返回，即使数据大小小于可写入的总的数据大小（所以如果要等待写入指定大小的数据的话，需要通过readv的返回值进行判断？）")],-1)),i[24]||(i[24]=s("p",null,[s("span",{style:{background:"#fff88f"}},"问："),a("为什么输入12回车回车时，第一个回车没有结束输入，而是要再输入一个回车？而其他的输入第一个回车后就结束输入？")],-1)),i[25]||(i[25]=s("h3",{id:"优点",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#优点"},[s("span",null,"优点")])],-1)),i[26]||(i[26]=s("p",null,[a("避免多次调用read、write，这样在关闭了Nagle 算法时，使用write多包发送的数据可以通过单包发送。"),s("br"),a(" 或者数据类型、内容的来源、去向不同时更容易区分")],-1))])}const C=r(v,[["render",b]]),f=JSON.parse('{"path":"/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/13.1%20send_%20recv%20%E5%87%BD%E6%95%B0.html","title":"13.1 send& recv 函数","lang":"zh-CN","frontmatter":{"category":"网络编程","description":"13.1 send& recv 函数 send 相关信息 The send() call may be used only when the socket is in a connected state (so that the intended recipient is known). The only difference between send...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"13.1 send& recv 函数\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-12-26T17:40:11.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"mingStudent\\"}]}"],["meta",{"property":"og:url","content":"https://guzhoutingxue.github.io/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/13.1%20send_%20recv%20%E5%87%BD%E6%95%B0.html"}],["meta",{"property":"og:title","content":"13.1 send& recv 函数"}],["meta",{"property":"og:description","content":"13.1 send& recv 函数 send 相关信息 The send() call may be used only when the socket is in a connected state (so that the intended recipient is known). The only difference between send..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-26T17:40:11.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-26T17:40:11.000Z"}]]},"git":{"createdTime":1766770811000,"updatedTime":1766770811000,"contributors":[{"name":"guZhouTingXue","username":"guZhouTingXue","email":"2422173022@qq.com","commits":1,"url":"https://github.com/guZhouTingXue"}]},"readingTime":{"minutes":12.05,"words":3615},"filePathRelative":"网络编程/13.1 send& recv 函数.md","excerpt":"","autoDesc":true}');export{C as comp,f as data};
