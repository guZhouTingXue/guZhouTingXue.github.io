---
category: 网络编程
---
# 8.1 域名系统
DNS - Domain Name System
>[!quote]
>DNS 是对IP地址和域名进行相互转换的系统，其核心是DNS服务器。

- 域名
- DNS服务器
<!--more-->


域名：
类似于 \https://wiki.wireshark.org/SampleCaptures 由具有实际含义、便于记忆的单词 + 分隔符构成的

使用nslookup 命令查看DNS相关信息
nslookup 有两种使用模式：interactive 和 non-interactive，直接输入nslookup 回车，进入interactive 模式
``` 
PS C:\Users\mingstudent\Desktop> nslookup
默认服务器:  XiaoQiang
Address:  192.168.31.1
> 
```
	返回默认的服务器名称及其ip地址.
在interactive 模式下输入exit 退出

输入域名，查询域名对应的ip地址：
``` 
> www.baidu.com
服务器:  XiaoQiang
Address:  192.168.31.1

非权威应答:
名称:    www.a.shifen.com
Addresses:  2408:873d:22:1a91:0:ff:b013:cf81
          2408:873d:22:18cb:0:ff:b037:e6d8
          153.3.238.28
          153.3.238.127
Aliases:  www.baidu.com
```

| 行号   | 说明                                      |
| ---- | --------------------------------------- |
| 5    | 收到的回复不是来自管理域名的官方DNS服务器的应答，而是来自路由器内缓存的信息 |
| 6    | 实际的域名                                   |
| 7-10 | 服务器列表，一个域名可以有多个服务器来响应请求，分担压力。这里既有ipv4   |
| 11   |                                         |

DNS 解析的过程：
``` mermaid
sequenceDiagram
    box rgb(237, 165, 211) 局域网
        participant Computer as 主机
        participant DefaultDNS as xiaoqiang
    end
    
    participant Dns2 as DNS服务器
    participant DnsRoot as 根DNS服务器
    participant Dns3 as DNS服务器

    box rgb(116, 225, 211) 局域网
        participant DestDefaultDNS as 默认DNS服务器
        participant Dest as 目标服务器
    end
    Computer ->> DefaultDNS: 帮我解析www.baidu.com
    DefaultDNS ->> Dns2: 我不知道，你知不知道
    
    Dns2 ->> DnsRoot: 我不知道，你知不知道
    DnsRoot ->> Dns3: 我不知道，你知不知道

    Dns3 ->> DestDefaultDNS: 我不知道，你知不知道
    DestDefaultDNS ->> Dest: 你是不是www.baidu.com 的服务器
    
    Dest -->> DestDefaultDNS: 我是，我的ip地址是153.3.238.28
    DestDefaultDNS -->> Dns3: 服务器ip地址是153.3.238.28
    Dns3 -->> DnsRoot: 服务器ip地址是153.3.238.28
    DnsRoot -->> Dns2: 服务器ip地址是153.3.238.28
    Dns2 -->> DefaultDNS: 服务器ip地址是153.3.238.28
    DefaultDNS -->> Computer: 服务器ip地址是153.3.238.28
```

主机首先先默认DNS服务器发送解析请求，如果默认DNS服务器无法解析就会向上级DNS服务器传递请求，直到根DNS服务器。根服务器会向下级DNS传递，找到域名对应的服务器后将服务器ip地址原路返回。这样所有查找路径上的DNS服务器 以及 发送请求的主机都获知了请求域名的服务器ip地址。